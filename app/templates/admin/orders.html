{% extends 'base.html' %}
{% block content %}

{% include 'admin/nav.html' %}

<a href="{{ url_for('admin.add_order') }}" class="btn btn-primary btn-lg float-right">
  <i class="fas fa-plus"></i>
  Add Order
</a>

<h1>Orders</h1>

<table class="table table-striped table-hover datatable">
  <thead>
    <tr>
      <th>#</th>
      <th>User</th>
      <th>Items</th>
      <th>Total</th>
      <th>Shipping</th>
      <th>Payment</th>
      <th>Status</th>
      <th>Created</th>
    </tr>
  </thead>
  <tbody>
    {% for order in orders %}
      <tr>
        <td>
          <a href="{{ url_for('admin.view_order', obj_id=order.id) }}">
            <i class="fas fa-eye"></i>
            Order #{{ order.id }}
          </a>
        </td>
        <td class="text-center">
          {% if order.user %}
            {{ order.user.email }}
          {% endif %}
        </td>
        <td>
          <ul>
            {% for item in order.items %}
              <li>
                {{ item.product.name }} -
                {{ item.option.name }}
                (x{{ item.amount }})
              </li>
            {% endfor %}
          </ul>
        </td>
        <td>
          ${{ order.total_cost() }}
        </td>
        <td>
          {% if order.shipping %}
            {{ order.shipping.address_1 }}
          {% endif %}
        </td>
        <td>
          {% if order.payment_id %}
            <a href="https://dashboard.stripe.com/{% if config.get('DEVELOPMENT') %}test/{% endif %}payments/{{ order.payment_id }}" target='_blank'>
              {{ order.payment_id }}
            </a>
          {% endif %}
        </td>
        <td>
          {{ order.status }}
        </td>
        <td>
          {{ order.created }}
        </td>
      </tr>
    {% endfor %}
  </tbody>
</table>

{% endblock %}
